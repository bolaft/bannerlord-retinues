<?xml version="1.0" encoding="utf-8"?>
<Widget Id="CCT_TroopsRoot" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" IsVisible="@IsTroopsSelected" DoNotAcceptEvents="false">
  <Children>
    <!-- ===================== RIGHT PANEL ===================== -->
    <Widget WidthSizePolicy="StretchToParent"
            HeightSizePolicy="StretchToParent"
            MarginLeft="600"
            MarginRight="290"
            IsVisible="@IsAnyTroopSelected">
      <Children>
        <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent">
          <Children>
            <!-- Stats / header -->
            <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginRight="290">
              <Children>
                <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="465" SuggestedHeight="512" HorizontalAlignment="Left">
                  <Children>
                    <CharacterTableauWidget DataSource="{TroopInfo}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="550" SuggestedHeight="900" HorizontalAlignment="Center" VerticalAlignment="Center" BannerCodeText="@BannerCodeText" CharStringId="@CharStringId" EquipmentCode="@EquipmentCode" BodyProperties="@BodyProperties" IsFemale="@IsFemale" MountCreationKey="@MountCreationKey" Race="@Race" StanceIndex="@StanceIndex" ArmorColor1="@ArmorColor1" ArmorColor2="@ArmorColor2" DoNotUseCustomScale="true">
                      <Children>
                      </Children>
                    </CharacterTableauWidget>
                  </Children>
                </Widget>
              </Children>
            </Widget>
            <Widget VisualDefinition="RightPanel" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" PositionXOffset="800" MarginLeft="340">
              <Children>
                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" MarginLeft="20" MarginRight="20" StackLayout.LayoutMethod="VerticalBottomToTop">
                  <Children>
                    <!-- Name Header -->
                    <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" Text="Name" Brush="Kingdom.TitleSmall.Text" MarginTop="15" MarginBottom="10"/>

                    <!-- Name row -->
                    <ListPanel Id="HeroNameParent" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginBottom="15" StackLayout.LayoutMethod="HorizontalLeftToRight" UpdateChildrenStates="true">
                      <Children>
                        <!-- Bind to selected troop -->
                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginRight="8" Brush="Clan.RightPanel.Name.Text" DataSource="{TroopRow}" Text="@Name" ClipContents="false" />

                        <!-- Rename button -->
                        <ButtonWidget DoNotPassEventsToChildren="true"
                                      WidthSizePolicy="CoverChildren"
                                      HeightSizePolicy="CoverChildren"
                                      MarginLeft="6"
                                      DataSource="{TroopEditor}"
                                      Command.Click="ExecuteRenameSelected"
                                      UpdateChildrenStates="true">
                          <Children>
                            <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed"
                                        SuggestedWidth="32" SuggestedHeight="32"
                                        Brush="SPClan.NameChange.Icon" />
                          </Children>
                        </ButtonWidget>
                      </Children>
                    </ListPanel>

                    <!-- Gender Header -->
                    <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" Text="Gender" Brush="Kingdom.TitleSmall.Text" MarginTop="15" MarginBottom="10"/>

                    <!-- Gender row -->
                    <ListPanel Id="HeroNameParent" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginBottom="15" StackLayout.LayoutMethod="HorizontalLeftToRight" UpdateChildrenStates="true">
                      <Children>
                        <!-- Bind to selected troop -->
                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginRight="8" Brush="Clan.RightPanel.Name.Text" DataSource="{TroopInfo}" Text="@Gender" ClipContents="false" />

                        <!-- Rename button -->
                        <ButtonWidget DoNotPassEventsToChildren="true"
                                      WidthSizePolicy="CoverChildren"
                                      HeightSizePolicy="CoverChildren"
                                      MarginLeft="6"
                                      DataSource="{TroopEditor}"
                                      Command.Click="ExecuteChangeGenderSelected"
                                      UpdateChildrenStates="true">
                          <Children>
                            <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed"
                                        SuggestedWidth="32" SuggestedHeight="32"
                                        Brush="SPClan.NameChange.Icon" />
                          </Children>
                        </ButtonWidget>
                      </Children>
                    </ListPanel>

                    <!-- Skills Header -->
                    <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" Text="Skills" Brush="Kingdom.TitleSmall.Text" MarginTop="15" MarginBottom="10"/>

                    <!-- Skill Points -->
                    <ListPanel Id="HeroNameParent" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginBottom="15" StackLayout.LayoutMethod="HorizontalLeftToRight" UpdateChildrenStates="true">
                      <Children>
                        <!-- Bind to selected troop -->
                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginRight="8" Brush="Clan.RightPanel.Name.Text" DataSource="{TroopInfo}" IntText="@SkillPointsUsed" ClipContents="false" />
                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginRight="8" Brush="Clan.RightPanel.Name.Text" Text="/" ClipContents="false" />
                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginRight="8" Brush="Clan.RightPanel.Name.Text" DataSource="{TroopInfo}" IntText="@SkillPointsTotal" ClipContents="false" />
                      </Children>
                    </ListPanel>

                    <!-- Skills Icon Grid: 2 rows, 4 columns -->
                    <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" StackLayout.LayoutMethod="VerticalBottomToTop" UpdateChildrenStates="true">
                      <Children>
                        <!-- First row -->
                        <ListPanel HorizontalAlignment="Center" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="HorizontalLeftToRight" MarginBottom="5" UpdateChildrenStates="true">
                          <Children>
                            <ListPanel WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="110" StackLayout.LayoutMethod="VerticalBottomToTop" HorizontalAlignment="Center" MarginRight="40" MarginBottom="20">
                              <Children>
                                <SkillIconVisualWidget MarginBottom="6" SkillId="athletics" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="80" DoNotPassEventsToChildren="false"/>
                                
                                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="HorizontalLeftToRight" HorizontalAlignment="Center" UpdateChildrenStates="true">
                                  <Children>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonRightBigArrowBrush1" Command.Click="ExecuteDecrementAthletics" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                    <TextWidget DataSource="{TroopInfo}" IntText="@Athletics" WidthSizePolicy="Fixed" SuggestedWidth="32" HeightSizePolicy="Fixed" SuggestedHeight="24" Brush="Encyclopedia.Skill.Text" Brush.FontSize="24" Brush.FontColor="#F4E1C4FF" HorizontalAlignment="Center"/>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonLeftBigArrowBrush1" Command.Click="ExecuteIncrementAthletics" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                  </Children>
                                </ListPanel>
                              </Children>
                            </ListPanel>
                            <ListPanel WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="110" StackLayout.LayoutMethod="VerticalBottomToTop" HorizontalAlignment="Center" MarginRight="40" MarginBottom="20">
                              <Children>
                                <SkillIconVisualWidget MarginBottom="6" SkillId="riding" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="80" DoNotPassEventsToChildren="false"/>
                                
                                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="HorizontalLeftToRight" HorizontalAlignment="Center" UpdateChildrenStates="true">
                                  <Children>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonRightBigArrowBrush1" Command.Click="ExecuteDecrementRiding" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                    <TextWidget DataSource="{TroopInfo}" IntText="@Riding" WidthSizePolicy="Fixed" SuggestedWidth="32" HeightSizePolicy="Fixed" SuggestedHeight="24" Brush="Encyclopedia.Skill.Text" Brush.FontSize="24" Brush.FontColor="#F4E1C4FF" HorizontalAlignment="Center"/>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonLeftBigArrowBrush1" Command.Click="ExecuteIncrementRiding" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                  </Children>
                                </ListPanel>
                              </Children>
                            </ListPanel>
                            <ListPanel WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="110" StackLayout.LayoutMethod="VerticalBottomToTop" HorizontalAlignment="Center" MarginRight="40" MarginBottom="20">
                              <Children>
                                <SkillIconVisualWidget MarginBottom="6" SkillId="onehanded" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="80" DoNotPassEventsToChildren="false"/>
                                
                                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="HorizontalLeftToRight" HorizontalAlignment="Center" UpdateChildrenStates="true">
                                  <Children>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonRightBigArrowBrush1" Command.Click="ExecuteDecrementOneHanded" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                    <TextWidget DataSource="{TroopInfo}" IntText="@OneHanded" WidthSizePolicy="Fixed" SuggestedWidth="32" HeightSizePolicy="Fixed" SuggestedHeight="24" Brush="Encyclopedia.Skill.Text" Brush.FontSize="24" Brush.FontColor="#F4E1C4FF" HorizontalAlignment="Center"/>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonLeftBigArrowBrush1" Command.Click="ExecuteIncrementOneHanded" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                  </Children>
                                </ListPanel>
                              </Children>
                            </ListPanel>
                            <ListPanel WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="110" StackLayout.LayoutMethod="VerticalBottomToTop" HorizontalAlignment="Center" MarginRight="0" MarginBottom="20">
                              <Children>
                                <SkillIconVisualWidget MarginBottom="6" SkillId="twohanded" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="80" DoNotPassEventsToChildren="false"/>
                                
                                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="HorizontalLeftToRight" HorizontalAlignment="Center" UpdateChildrenStates="true">
                                  <Children>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonRightBigArrowBrush1" Command.Click="ExecuteDecrementTwoHanded" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                    <TextWidget DataSource="{TroopInfo}" IntText="@TwoHanded" WidthSizePolicy="Fixed" SuggestedWidth="32" HeightSizePolicy="Fixed" SuggestedHeight="24" Brush="Encyclopedia.Skill.Text" Brush.FontSize="24" Brush.FontColor="#F4E1C4FF" HorizontalAlignment="Center"/>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonLeftBigArrowBrush1" Command.Click="ExecuteIncrementTwoHanded" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                  </Children>
                                </ListPanel>
                              </Children>
                            </ListPanel>
                          </Children>
                        </ListPanel>
                        <!-- Second row (fixed: match first row's margins and centering) -->
                        <ListPanel HorizontalAlignment="Center" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="HorizontalLeftToRight" MarginBottom="5" UpdateChildrenStates="true">
                          <Children>
                            <ListPanel WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="110" StackLayout.LayoutMethod="VerticalBottomToTop" HorizontalAlignment="Center" MarginRight="40" MarginBottom="20">
                              <Children>
                                <SkillIconVisualWidget MarginBottom="6" SkillId="polearm" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="80" DoNotPassEventsToChildren="false"/>
                                
                                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="HorizontalLeftToRight" HorizontalAlignment="Center" UpdateChildrenStates="true">
                                  <Children>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonRightBigArrowBrush1" Command.Click="ExecuteDecrementPolearm" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                    <TextWidget DataSource="{TroopInfo}" IntText="@Polearm" WidthSizePolicy="Fixed" SuggestedWidth="32" HeightSizePolicy="Fixed" SuggestedHeight="24" Brush="Encyclopedia.Skill.Text" Brush.FontSize="24" Brush.FontColor="#F4E1C4FF" HorizontalAlignment="Center"/>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonLeftBigArrowBrush1" Command.Click="ExecuteIncrementPolearm" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                  </Children>
                                </ListPanel>
                              </Children>
                            </ListPanel>
                            <ListPanel WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="110" StackLayout.LayoutMethod="VerticalBottomToTop" HorizontalAlignment="Center" MarginRight="40" MarginBottom="20">
                              <Children>
                                <SkillIconVisualWidget MarginBottom="6" SkillId="bow" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="80" DoNotPassEventsToChildren="false"/>
                                
                                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="HorizontalLeftToRight" HorizontalAlignment="Center" UpdateChildrenStates="true">
                                  <Children>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonRightBigArrowBrush1" Command.Click="ExecuteDecrementBow" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                    <TextWidget DataSource="{TroopInfo}" IntText="@Bow" WidthSizePolicy="Fixed" SuggestedWidth="32" HeightSizePolicy="Fixed" SuggestedHeight="24" Brush="Encyclopedia.Skill.Text" Brush.FontSize="24" Brush.FontColor="#F4E1C4FF" HorizontalAlignment="Center"/>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonLeftBigArrowBrush1" Command.Click="ExecuteIncrementBow" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                  </Children>
                                </ListPanel>
                              </Children>
                            </ListPanel>
                            <ListPanel WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="110" StackLayout.LayoutMethod="VerticalBottomToTop" HorizontalAlignment="Center" MarginRight="40" MarginBottom="20">
                              <Children>
                                <SkillIconVisualWidget MarginBottom="6" SkillId="crossbow" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="80" DoNotPassEventsToChildren="false"/>
                                
                                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="HorizontalLeftToRight" HorizontalAlignment="Center" UpdateChildrenStates="true">
                                  <Children>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonRightBigArrowBrush1" Command.Click="ExecuteDecrementCrossbow" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                    <TextWidget DataSource="{TroopInfo}" IntText="@Crossbow" WidthSizePolicy="Fixed" SuggestedWidth="32" HeightSizePolicy="Fixed" SuggestedHeight="24" Brush="Encyclopedia.Skill.Text" Brush.FontSize="24" Brush.FontColor="#F4E1C4FF" HorizontalAlignment="Center"/>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonLeftBigArrowBrush1" Command.Click="ExecuteIncrementCrossbow" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                  </Children>
                                </ListPanel>
                              </Children>
                            </ListPanel>
                            <ListPanel WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="110" StackLayout.LayoutMethod="VerticalBottomToTop" HorizontalAlignment="Center" MarginRight="0" MarginBottom="20">
                              <Children>
                                <SkillIconVisualWidget MarginBottom="6" SkillId="throwing" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="80" DoNotPassEventsToChildren="false"/>
                                
                                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="HorizontalLeftToRight" HorizontalAlignment="Center" UpdateChildrenStates="true">
                                  <Children>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonRightBigArrowBrush1" Command.Click="ExecuteDecrementThrowing" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                    <TextWidget DataSource="{TroopInfo}" IntText="@Throwing" WidthSizePolicy="Fixed" SuggestedWidth="32" HeightSizePolicy="Fixed" SuggestedHeight="24" Brush="Encyclopedia.Skill.Text" Brush.FontSize="24" Brush.FontColor="#F4E1C4FF" HorizontalAlignment="Center"/>
                                    <ButtonWidget DataSource="{TroopEditor}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="24" SuggestedHeight="24" Brush="ButtonLeftBigArrowBrush1" Command.Click="ExecuteIncrementThrowing" DoNotPassEventsToChildren="true" UpdateChildrenStates="true"/>
                                  </Children>
                                </ListPanel>
                              </Children>
                            </ListPanel>
                          </Children>
                        </ListPanel>
                      </Children>
                    </ListPanel>
                  </Children>
                </ListPanel>
              </Children>
            </Widget>
          </Children>
        </Widget>
      </Children>
    </Widget>
    <!-- =================== /RIGHT PANEL ====================== -->

    <!-- LEFT PANEL (same margins/frame as other tabs) -->
    <BrushListPanel IsVisible="@IsTroopsSelected" WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" VerticalAlignment="Bottom" MarginTop="6" MarginBottom="9" MarginLeft="27" Brush="Frame1Brush" StackLayout.LayoutMethod="VerticalBottomToTop">
        <Children>
        <!--Horizontal Header Section-->
        <NavigationScopeTargeter ScopeID="SortButtonsScope" ScopeParent="..\SortButtons" ScopeMovements="Horizontal"/>
        <ListPanel Id="SortButtons" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" RenderLate="true" DataSource="{SortController}">
            <Children>
            <!-- WIDTH/HEIGHT switched to clan members header constants -->
            <SortButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="588" SuggestedHeight="!Clan.Members.Sort.1.Height" Brush="Clan.Members.Sort.1" Command.Click="ExecuteSortByName" IsSelected="@IsNameSelected" SortState="@NameState" SortVisualWidget="TextWidget\NameSortVisualWidget" UpdateChildrenStates="true" GamepadNavigationIndex="0">
                <Children>
                <TextWidget Id="TextWidget" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="Clan.LeftPanel.Header.Text" ClipContents="false" Text="Custom Units">
                    <Children>
                    <BrushWidget Id="NameSortVisualWidget" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="20" SuggestedHeight="20" HorizontalAlignment="Right" VerticalAlignment="Center" PositionXOffset="20" Brush="ArmyManagement.Sort.ArrowBrush"/>
                    </Children>
                </TextWidget>
                </Children>
            </SortButtonWidget>
            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Scroll.Header.Width" SuggestedHeight="!Scroll.Header.Height" Sprite="StdAssets\scroll_header" ExtendRight="3" ExtendTop="6" ExtendLeft="3" ExtendBottom="4" HorizontalAlignment="Right"/>
            </Children>
        </ListPanel>
        <!-- SCROLL GROUP (first child; header draws after) -->
        <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent">
            <Children>
            <!-- Scrollable area -->
            <ScrollablePanel Id="CCT_ClanElementsScrollablePanel" WidthSizePolicy="CoverChildren" MinWidth="!Clan.Management.Collapser.Width" HeightSizePolicy="StretchToParent" MarginLeft="3" MarginBottom="3" AutoHideScrollBars="true" ClipRect="CCT_ClanElementsRect" InnerPanel="CCT_ClanElementsRect\CCT_ClanElementsListPanel" MouseScrollAxis="Vertical" VerticalScrollbar="..\CCT_ClanElementsScrollbar\Scrollbar">
                <Children>
                <!-- Navigation + clipping rect -->
                <NavigationScopeTargeter ScopeID="CCT_TroopsScope" ScopeParent=".\CCT_ClanElementsRect" ScopeMovements="Vertical" IsDefaultNavigationScope="true" DoNotAutoNavigateAfterSort="true"/>
                <Widget Id="CCT_ClanElementsRect" WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" ClipContents="true">
                    <Children>
                    <!-- Vertical list inside the scroll area -->
                    <NavigatableListPanel Id="CCT_ClanElementsListPanel" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop" MinIndex="0" StepSize="1000">
                        <Children>
                        <!-- ELITE anchor + list -->
                        <NavigationAutoScrollWidget TrackedWidget=".\CCT_EliteHeader"/>
                        <ScrollablePanelFixedHeaderWidget Id="CCT_EliteHeader" FixedHeader="..\..\..\CCT_EliteToggle" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Clan.Management.Collapser.Width" HeaderHeight="!Clan.Management.Collapser.Height" AdditionalBottomOffset="!Clan.Members.Sort.1.Height"/>
                        <!-- CHANGED: bind to CustomElite -->
                        <NavigatableListPanel Id="CCT_EliteList" DataSource="{CustomElite}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Right" StackLayout.LayoutMethod="VerticalBottomToTop" UseSelfIndexForMinimum="true">
                            <ItemTemplate>
                            <ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedHeight="68" SuggestedWidth="!Clan.Management.Collapser.Width" Brush="Clan.Management.LeftTuple" IsSelected="@IsSelected" Command.Click="ExecuteSelect" UpdateChildrenStates="true">
                                <Children>
                                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="24" MarginRight="24" StackLayout.LayoutMethod="HorizontalLeftToRight">
                                    <Children>
                                    <!-- Name on the left -->
                                    <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" VerticalAlignment="Center" Brush="Clan.Tuple.Name.Text" ClipContents="false" Text="@Name"/>
                                    <!-- Tier badge on the right -->
                                    <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" VerticalAlignment="Center" Brush="Clan.Tuple.Name.Text" HorizontalAlignment="Right" Text="@TierText"/>
                                    </Children>
                                </ListPanel>
                                </Children>
                            </ButtonWidget>
                            </ItemTemplate>
                        </NavigatableListPanel>
                        <!-- REGULAR anchor + list -->
                        <NavigationAutoScrollWidget TrackedWidget=".\CCT_RegularHeader"/>
                        <ScrollablePanelFixedHeaderWidget Id="CCT_RegularHeader" FixedHeader="..\..\..\CCT_RegularToggle" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Clan.Management.Collapser.Width" HeaderHeight="!Clan.Management.Collapser.Height"/>
                        <!-- CHANGED: bind to CustomBasic -->
                        <NavigatableListPanel Id="CCT_RegularList" DataSource="{CustomBasic}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Right" StackLayout.LayoutMethod="VerticalBottomToTop" UseSelfIndexForMinimum="true">
                            <ItemTemplate>
                            <!-- Button wiring kept identical; item VM should expose IsSelected/ExecuteSelect if you want selection -->
                            <ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedHeight="68" SuggestedWidth="!Clan.Management.Collapser.Width" Brush="Clan.Management.LeftTuple" IsSelected="@IsSelected" Command.Click="ExecuteSelect" UpdateChildrenStates="true">
                                <Children>
                                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="24" MarginRight="24" StackLayout.LayoutMethod="HorizontalLeftToRight">
                                    <Children>
                                    <!-- Name on the left -->
                                    <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" VerticalAlignment="Center" Brush="Clan.Tuple.Name.Text" ClipContents="false" Text="@Name"/>
                                    <!-- Tier badge on the right -->
                                    <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" VerticalAlignment="Center" Brush="Clan.Tuple.Name.Text" HorizontalAlignment="Right" Text="@TierText"/>
                                    </Children>
                                </ListPanel>
                                </Children>
                            </ButtonWidget>
                            </ItemTemplate>
                        </NavigatableListPanel>
                        </Children>
                    </NavigatableListPanel>
                    </Children>
                </Widget>
                <!-- REGULAR toggle (sibling under the ScrollablePanel) -->
                <PartyHeaderToggleWidget Id="CCT_RegularToggle" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Clan.Management.Collapser.Width" SuggestedHeight="!Clan.Management.Collapser.Height" CollapseIndicator="RegularCollapser\RegularCollapseIndicator" ListPanel="..\CCT_ClanElementsRect\CCT_ClanElementsListPanel\CCT_RegularList" HorizontalAlignment="Left" VerticalAlignment="Top" Brush="Clan.Management.Collapser" WidgetToClose="..\CCT_ClanElementsRect\CCT_ClanElementsListPanel\CCT_RegularList">
                    <Children>
                    <ListPanel Id="RegularCollapser" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Children>
                        <BrushWidget Id="RegularCollapseIndicator" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="16" SuggestedHeight="16" VerticalAlignment="Center" PositionYOffset="-2" MarginRight="5" Brush="Party.Toggle.ExpandIndicator"/>
                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" Brush="Clan.Management.Collapser.Text" Text="Regular"/>
                        </Children>
                    </ListPanel>
                    </Children>
                </PartyHeaderToggleWidget>
                <!-- ELITE toggle -->
                <PartyHeaderToggleWidget Id="CCT_EliteToggle" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Clan.Management.Collapser.Width" SuggestedHeight="!Clan.Management.Collapser.Height" CollapseIndicator="EliteCollapser\EliteCollapseIndicator" ListPanel="..\CCT_ClanElementsRect\CCT_ClanElementsListPanel\CCT_EliteList" HorizontalAlignment="Left" VerticalAlignment="Top" Brush="Clan.Management.Collapser" WidgetToClose="..\CCT_ClanElementsRect\CCT_ClanElementsListPanel\CCT_EliteList">
                    <Children>
                    <ListPanel Id="EliteCollapser" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Children>
                        <BrushWidget Id="EliteCollapseIndicator" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="16" SuggestedHeight="16" VerticalAlignment="Center" PositionYOffset="-2" MarginRight="5" Brush="Party.Toggle.ExpandIndicator"/>
                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" Brush="Clan.Management.Collapser.Text" Text="Elite"/>
                        </Children>
                    </ListPanel>
                    </Children>
                </PartyHeaderToggleWidget>
                </Children>
            </ScrollablePanel>
            <!-- Vertical Scrollbar (sibling of the scrollable area) -->
            <Standard.VerticalScrollbar Id="CCT_ClanElementsScrollbar" HeightSizePolicy="StretchToParent" HorizontalAlignment="Right" VerticalAlignment="Bottom" MarginLeft="2" MarginRight="2" MarginBottom="3"/>
            </Children>
        </ListPanel>
        </Children>
    </BrushListPanel>
  </Children>
</Widget>